{% extends "base.html" %}

{% block title %}ãƒ­ã‚°è¨­å®š - Accel MCP{% endblock %}

{% block breadcrumb %}
<nav class="breadcrumb">
    <a href="/dashboard" data-i18n="breadcrumb_home">ãƒ›ãƒ¼ãƒ </a>
    <span class="breadcrumb-separator">â€º</span>
    <a href="/connection-logs" data-i18n="connection_logs_title">æ¥ç¶šãƒ­ã‚°ç®¡ç†</a>
    <span class="breadcrumb-separator">â€º</span>
    <span class="breadcrumb-current" data-i18n="log_settings_title">ãƒ­ã‚°è¨­å®š</span>
</nav>
{% endblock %}

{% block content %}
<div class="page-title">
    <h2 data-i18n="log_settings_title">ãƒ­ã‚°è¨­å®š</h2>
    <p data-i18n="log_settings_desc">æ¥ç¶šãƒ­ã‚°ã®è¨˜éŒ²ã¨ãƒã‚¹ã‚­ãƒ³ã‚°è¨­å®šã‚’ç®¡ç†ã—ã¾ã™</p>
</div>

<form id="settings-form">
    <!-- Basic Settings -->
    <div class="form-section">
        <h3 data-i18n="log_settings_basic">åŸºæœ¬è¨­å®š</h3>
        
        <div class="form-group">
            <label class="toggle-label">
                <input type="checkbox" id="mcp_log_enabled" checked>
                <span class="toggle-switch"></span>
                <span data-i18n="log_settings_enabled">ãƒ­ã‚°è¨˜éŒ²ã‚’æœ‰åŠ¹ã«ã™ã‚‹</span>
            </label>
            <p class="form-hint" data-i18n="log_settings_enabled_hint">ç„¡åŠ¹ã«ã™ã‚‹ã¨ã€æ–°ã—ã„MCPæ¥ç¶šãƒ­ã‚°ã¯è¨˜éŒ²ã•ã‚Œã¾ã›ã‚“</p>
        </div>
        
        <div class="form-group">
            <label for="mcp_log_max_body_size" data-i18n="log_settings_max_body">ãƒªã‚¯ã‚¨ã‚¹ãƒˆ/ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒœãƒ‡ã‚£ã®æœ€å¤§ã‚µã‚¤ã‚ºï¼ˆãƒã‚¤ãƒˆï¼‰</label>
            <input type="number" id="mcp_log_max_body_size" class="form-control" value="10240" min="1024" max="102400" style="width: 150px;">
            <p class="form-hint" data-i18n="log_settings_max_body_hint">ã“ã®å€¤ã‚’è¶…ãˆã‚‹ãƒœãƒ‡ã‚£ã¯åˆ‡ã‚Šæ¨ã¦ã‚‰ã‚Œã¾ã™</p>
        </div>
    </div>
    
    <!-- Masking Settings -->
    <div class="form-section">
        <h3 data-i18n="log_settings_masking">ãƒã‚¹ã‚­ãƒ³ã‚°è¨­å®š</h3>
        <p class="section-desc" data-i18n="log_settings_masking_desc">å€‹äººæƒ…å ±ã‚„æ©Ÿå¯†æƒ…å ±ã‚’è‡ªå‹•çš„ã«ãƒã‚¹ã‚¯ã—ã¾ã™ã€‚ãƒã‚¹ã‚¯ã•ã‚ŒãŸæƒ…å ±ã¯ [MASKED] ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚</p>
        
        <div class="form-group">
            <label class="checkbox-label">
                <input type="checkbox" id="mcp_log_mask_credit_card" checked>
                <span data-i18n="log_mask_credit_card">ã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ç•ªå·</span>
            </label>
            <p class="form-hint" data-i18n="log_mask_credit_card_hint">16æ¡ã®æ•°å­—ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆä¾‹: 1234-5678-9012-3456ï¼‰</p>
        </div>
        
        <div class="form-group">
            <label class="checkbox-label">
                <input type="checkbox" id="mcp_log_mask_email" checked>
                <span data-i18n="log_mask_email">ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</span>
            </label>
            <p class="form-hint" data-i18n="log_mask_email_hint">example@domain.com å½¢å¼ã®ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹</p>
        </div>
        
        <div class="form-group">
            <label class="checkbox-label">
                <input type="checkbox" id="mcp_log_mask_phone" checked>
                <span data-i18n="log_mask_phone">é›»è©±ç•ªå·</span>
            </label>
            <p class="form-hint" data-i18n="log_mask_phone_hint">ä¸€èˆ¬çš„ãªé›»è©±ç•ªå·ãƒ‘ã‚¿ãƒ¼ãƒ³</p>
        </div>
        
        <div class="form-group">
            <label for="mcp_log_mask_custom_patterns" data-i18n="log_mask_custom">ã‚«ã‚¹ã‚¿ãƒ ãƒã‚¹ã‚­ãƒ³ã‚°ãƒ‘ã‚¿ãƒ¼ãƒ³ï¼ˆæ­£è¦è¡¨ç¾ï¼‰</label>
            <textarea id="mcp_log_mask_custom_patterns" class="form-control" rows="4" placeholder="1è¡Œã«1ã¤ã®æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…¥åŠ›"></textarea>
            <p class="form-hint" data-i18n="log_mask_custom_hint">1è¡Œã«1ã¤ã®æ­£è¦è¡¨ç¾ãƒ‘ã‚¿ãƒ¼ãƒ³ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ã€‚ä¾‹: (?i)password["\s:=]+[^\s"',}]+</p>
        </div>
    </div>
    
    <!-- Save Button -->
    <div class="form-actions">
        <button type="submit" class="btn btn-primary" data-i18n="btn_save">ä¿å­˜</button>
    </div>
</form>

<!-- Log Cleanup Section -->
<div class="form-section cleanup-section">
    <h3 data-i18n="log_cleanup_title">ãƒ­ã‚°ã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—</h3>
    <p class="section-desc" data-i18n="log_cleanup_desc">æŒ‡å®šã—ãŸæ—¥æ•°ã‚ˆã‚Šå¤ã„ãƒ­ã‚°ã‚’å‰Šé™¤ã—ã¾ã™ã€‚ã“ã®æ“ä½œã¯å…ƒã«æˆ»ã›ã¾ã›ã‚“ã€‚</p>
    
    <div class="cleanup-form">
        <div class="form-group">
            <label for="cleanup-days" data-i18n="log_cleanup_days">å‰Šé™¤ã™ã‚‹æ—¥æ•°</label>
            <input type="number" id="cleanup-days" class="form-control" value="90" min="1" style="width: 120px;">
            <span class="form-hint" data-i18n="log_cleanup_days_hint">æ—¥ã‚ˆã‚Šå¤ã„ãƒ­ã‚°ã‚’å‰Šé™¤</span>
        </div>
        <button type="button" id="cleanup-btn" class="btn btn-danger" data-i18n="log_cleanup_button">
            <span style="margin-right: 4px;">ğŸ—‘ï¸</span>å¤ã„ãƒ­ã‚°ã‚’å‰Šé™¤
        </button>
    </div>
    
    <div id="cleanup-result" class="cleanup-result" style="display: none;"></div>
</div>

<style>
.form-section {
    background: #fff;
    border: 1px solid #e0e0e0;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
}

.form-section h3 {
    margin: 0 0 8px 0;
    color: #333;
}

.section-desc {
    color: #666;
    margin-bottom: 20px;
}

.form-group {
    margin-bottom: 20px;
}

.form-group label {
    display: block;
    font-weight: 500;
    margin-bottom: 6px;
    color: #333;
}

.form-hint {
    font-size: 0.85rem;
    color: #666;
    margin-top: 4px;
}

.toggle-label {
    display: flex;
    align-items: center;
    gap: 12px;
    cursor: pointer;
    font-weight: 500;
}

.toggle-label input {
    display: none;
}

.toggle-switch {
    width: 48px;
    height: 26px;
    background: #ccc;
    border-radius: 13px;
    position: relative;
    transition: background 0.3s;
}

.toggle-switch::after {
    content: '';
    position: absolute;
    width: 22px;
    height: 22px;
    background: #fff;
    border-radius: 50%;
    top: 2px;
    left: 2px;
    transition: left 0.3s;
}

.toggle-label input:checked + .toggle-switch {
    background: #4caf50;
}

.toggle-label input:checked + .toggle-switch::after {
    left: 24px;
}

.checkbox-label {
    display: flex;
    align-items: center;
    gap: 8px;
    cursor: pointer;
    font-weight: 500;
}

.checkbox-label input {
    width: 18px;
    height: 18px;
}

.form-actions {
    padding: 20px 0;
}

.cleanup-section {
    border-color: #ffcdd2;
    background: #fff8f8;
}

.cleanup-form {
    display: flex;
    align-items: flex-end;
    gap: 16px;
    flex-wrap: wrap;
}

.cleanup-form .form-group {
    margin-bottom: 0;
    display: flex;
    align-items: center;
    gap: 8px;
}

.btn-danger {
    background: #f44336;
    color: #fff;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
}

.btn-danger:hover {
    background: #d32f2f;
}

.cleanup-result {
    margin-top: 16px;
    padding: 12px 16px;
    border-radius: 4px;
}

.cleanup-result.success {
    background: #e8f5e9;
    color: #2e7d32;
}

.cleanup-result.error {
    background: #ffebee;
    color: #c62828;
}
</style>
{% endblock %}

{% block scripts %}
<script src="/assets/view/connection_logs/settings.js"></script>
{% endblock %}
