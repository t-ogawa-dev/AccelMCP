# ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆ - 5 åˆ†ã§ MCP ã‚µãƒ¼ãƒãƒ¼ã‚’è©¦ã™

ã“ã®ã‚¬ã‚¤ãƒ‰ã§ã¯ã€MCP ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•ã—ã¦ãƒ†ã‚¹ãƒˆã™ã‚‹ã¾ã§ã®æœ€çŸ­æ‰‹é †ã‚’èª¬æ˜ã—ã¾ã™ã€‚

## 1. ã‚µãƒ¼ãƒãƒ¼èµ·å‹• (1 åˆ†)

```bash
cd /Users/takahisaogawa/test/test2
docker-compose up -d
```

èµ·å‹•ã‚’å¾…ã¤:

```bash
docker-compose logs -f web
```

`Default admin user created` ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰èµ·å‹•å®Œäº†ã§ã™ã€‚

## 2. ç®¡ç†ç”»é¢ã§ãƒ­ã‚°ã‚¤ãƒ³ (1 åˆ†)

1. ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:5000 ã‚’é–‹ã
2. ãƒ­ã‚°ã‚¤ãƒ³:
   - ID: `admin`
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰: `admin123`

## 3. ãƒ†ã‚¹ãƒˆã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ (2 åˆ†)

### 3.1 ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²

1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ ã€Œã‚µãƒ¼ãƒ“ã‚¹ç®¡ç†ã€
2. ã€Œæ–°è¦ã‚µãƒ¼ãƒ“ã‚¹ç™»éŒ²ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. å…¥åŠ›:
   - **ã‚µãƒ¼ãƒ“ã‚¹å**: Weather Service
   - **ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³**: weather
   - **èª¬æ˜**: Test weather service
4. ã€Œç™»éŒ²ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 3.2 Capability ç™»éŒ²

1. ä½œæˆã—ãŸã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚¯ãƒªãƒƒã‚¯
2. ã€ŒCapabilities ç®¡ç†ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€Œæ–°è¦ Capability ç™»éŒ²ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. å…¥åŠ›:
   - **Capability å**: echo_test
   - **æ¥ç¶šã‚¿ã‚¤ãƒ—**: API
   - **æ¥ç¶šå…ˆ URL**: https://httpbin.org/post
   - **èª¬æ˜**: Simple echo test
   - **Body ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿**:
     ```
     message: Hello
     ```
5. ã€Œç™»éŒ²ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 3.3 ç®¡ç†è€…ã«æ¨©é™ä»˜ä¸

1. ãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ â†’ ã€Œãƒ¦ãƒ¼ã‚¶ãƒ¼ç®¡ç†ã€
2. ã€Œç®¡ç†è€…ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
3. ã€Œæ¨©é™ã‚’è¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯
4. ã‚µãƒ¼ãƒ“ã‚¹: Weather Service
5. Capability: echo_test
6. ã€Œè¿½åŠ ã€ã‚’ã‚¯ãƒªãƒƒã‚¯

### 3.4 Bearer ãƒˆãƒ¼ã‚¯ãƒ³å–å¾—

åŒã˜ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ã§ã€**Bearer ãƒˆãƒ¼ã‚¯ãƒ³**ã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã™ã€‚

## 4. MCP ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’ãƒ†ã‚¹ãƒˆ (1 åˆ†)

### 4.1 Capabilities å–å¾—

```bash
# TOKENã‚’ç½®ãæ›ãˆã¦ãã ã•ã„
TOKEN="YOUR_BEARER_TOKEN_HERE"

curl -H "Authorization: Bearer $TOKEN" \
  http://weather.lvh.me:5000/mcp
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**

```json
{
  "capabilities": {
    "tools": [
      {
        "name": "echo_test",
        "description": "Simple echo test",
        "inputSchema": {
          "type": "object",
          "properties": {
            "message": {
              "type": "string",
              "description": "Parameter: message",
              "default": "Hello"
            }
          }
        }
      }
    ]
  },
  "serverInfo": {
    "name": "Weather Service",
    "version": "1.0.0"
  }
}
```

### 4.2 Tool å®Ÿè¡Œ

```bash
curl -X POST \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"arguments": {"message": "Test from MCP"}}' \
  http://weather.lvh.me:5000/tools/echo_test
```

**æœŸå¾…ã•ã‚Œã‚‹å‡ºåŠ›:**

```json
{
  "content": [
    {
      "type": "text",
      "text": "{\"success\": true, \"status_code\": 200, \"data\": {...}}"
    }
  ],
  "isError": false
}
```

## 5. ãƒ†ã‚¹ãƒˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã‚’å®Ÿè¡Œ

```bash
# test_mcp.py ã‚’ç·¨é›†ã—ã¦ãƒˆãƒ¼ã‚¯ãƒ³ã‚’è¨­å®š
# BEARER_TOKEN = "YOUR_BEARER_TOKEN_HERE" ã®è¡Œã‚’å¤‰æ›´
# SUBDOMAIN = "weather" ã«å¤‰æ›´

python3 test_mcp.py
```

## å®Œäº†! ğŸ‰

ã“ã‚Œã§ä»¥ä¸‹ãŒã§ãã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã—ãŸ:

âœ… MCP ã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•  
âœ… Web ç®¡ç†ç”»é¢ã‹ã‚‰ã‚µãƒ¼ãƒ“ã‚¹ãƒ»Capabilityãƒ»æ¨©é™ã®ç®¡ç†  
âœ… ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ™ãƒ¼ã‚¹ã® MCP ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ã‚¢ã‚¯ã‚»ã‚¹  
âœ… Tool ã®å®Ÿè¡Œã¨ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ç¢ºèª

## æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### å®Ÿéš›ã® API ã‚’çµ±åˆã™ã‚‹

1. Web ç®¡ç†ç”»é¢ã§æ–°ã—ã„ Capability ã‚’ä½œæˆ
2. å®Ÿéš›ã® API URL (OpenWeather, GitHub, ãªã©) ã‚’è¨­å®š
3. API Key ã‚’ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«è¨­å®š
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã«æ¨©é™ã‚’ä»˜ä¸
5. MCP ã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆ (Dify, Claude Desktop) ã‹ã‚‰åˆ©ç”¨

### è¤‡æ•°ã®ã‚µãƒ¼ãƒ“ã‚¹ã‚’ç®¡ç†

1. å„ API ã”ã¨ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’ä½œæˆ
2. ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ã§åˆ†é›¢ (weather, github, database, etc.)
3. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã”ã¨ã«ç•°ãªã‚‹æ¨©é™ã‚’è¨­å®š

### MCP ã‚µãƒ¼ãƒãƒ¼ã®ä¸­ç¶™

1. ä»–ã® MCP ã‚µãƒ¼ãƒãƒ¼ã‚’ Capability ã¨ã—ã¦ç™»éŒ²
2. ã‚¿ã‚¤ãƒ—ã‚’ã€ŒMCPã€ã«è¨­å®š
3. è¤‡æ•°ã® MCP ã‚µãƒ¼ãƒãƒ¼ã‚’ 1 ã¤ã«çµ±åˆ

## ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

### lvh.me ãŒå‹•ä½œã—ãªã„

ä»£ã‚ã‚Šã«ä»¥ä¸‹ã‚’ä½¿ç”¨:

```bash
curl -H "Authorization: Bearer $TOKEN" \
  http://localhost:5000/mcp?subdomain=weather
```

### æ¨©é™ã‚¨ãƒ©ãƒ¼ãŒå‡ºã‚‹

1. ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°ç”»é¢ã§æ¨©é™ãŒæ­£ã—ãè¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
2. Capability åãŒæ­£ã—ã„ã‹ç¢ºèª
3. ã‚µãƒ–ãƒ‰ãƒ¡ã‚¤ãƒ³ãŒæ­£ã—ã„ã‹ç¢ºèª

### ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¨ãƒ©ãƒ¼

```bash
# ã‚³ãƒ³ãƒ†ãƒŠã‚’å†èµ·å‹•
docker-compose restart

# ã¾ãŸã¯å®Œå…¨ã«å†ãƒ“ãƒ«ãƒ‰
docker-compose down
docker-compose up -d --build
```

## ãã®ä»–ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ

- **è©³ç´°ãªä½¿ã„æ–¹**: `SETUP.md`
- **MCP ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆè©³ç´°**: `MCP_ENDPOINTS.md`
- **ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦**: `README.md`
